{% extends "base.html" %}
{% load filters %}

{% block conteudo %}

<div style="text-align: center;" class="container">
    <div class="intro">
        <div class="intro_img">
            <img src="{{livro.img.url}}" class="card-img-top" alt="capa">
        </div>
        <div class="intro_text">
            <h1> {{ livro.nome }} </h1>
            <h2> {{ livro.autor }} </h2>
            <h2> {{ livro.categoria }} </h2>
            <h3> {{ livro.data_cadastro }} </h3>
            <h3>Status: </h3>
            {% if livro.emprestado %}
            Indisponível
            {% else %}
            Disponível
            {% endif %}
        </div>
        <form action="{% url 'emprestimo:emprestimo' %}" method="POST" style="display:inline;">
            {% csrf_token %}
            <input type="hidden" name="matricula" value="{{ usuario.matricula }}">
            <input type="hidden" name="id" value="{{ livro.id }}">
            <button type="submit" class="btn btn-primary" style="margin-top: 1em;">Alugar</button>
        </form> 
    </div>
    <hr>
    <div class="historico_title">
        <h3>Histórico: </h3>
    </div>
    <div class="historico_info">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Último aluno</th>
                    <th scope="col">Data Empréstimo</th>
                    <th scope="col">Data retorno</th>
                    <th scope="col">Duração</th>
                </tr>
            </thead>
            <tbody>
                {% for emprestimo in emprestados %}
                <tr>
                    <th scope="row">{{ emprestimo.id }}</th>
                    <td>{{emprestimo.nome_estudante}}</td>
                    <td>{{emprestimo.data_emprestimo}}</td>
                    <td>{{emprestimo.data_devolvido}}</td>
                    <td>{{emprestimo.data_devolvido|calcula_duracao:emprestimo.data_emprestimo}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
